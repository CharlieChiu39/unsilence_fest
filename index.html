<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>å¯§éœéŸ³æ¨‚ç¯€ UNSILENCE FESTIVAL OS</title>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&display=swap" rel="stylesheet">
    <style>
        /* =========================================
           1. è®Šæ•¸è¨­å®š (è‰²å½©è¨ˆç•«èˆ‡æ¨¡å¼åˆ‡æ›)
           ========================================= */
        :root {
            --bg-color: #0a0510; 
            --text-color: #0f0; 
            --highlight-color: #ff00ff; 
            --sidebar-bg: #05020a;
            --win-bg: #c0c0c0; 
            --win-border: #9d00ff; 
            --win-text: #000; 
            --win-shadow: 4px 4px 0px #000; 
            --btn-bg: #dfdfdf;
            --crt-opacity: 1;
        }

        body.tranquil-mode { 
            --bg-color: #111; --text-color: #666; --highlight-color: #444; 
            --win-bg: #222; --win-border: #444; --win-text: #aaa; --btn-bg: #333; --crt-opacity: 0; 
        }

        body.pineapple-mode { 
            --bg-color: #1a1a00; --text-color: #00ff00; --highlight-color: #ff6600; 
            --win-bg: #fffbe6; --win-border: #ffcc00; --win-text: #004d00; --btn-bg: #ffee99; --win-shadow: 4px 4px 0px #331a00; 
        }

        body, html { 
            margin: 0; padding: 0; 
            height: 100vh; 
            height: 100dvh; 
            width: 100vw; 
            background-color: var(--bg-color); color: var(--text-color); 
            font-family: 'DotGothic16', sans-serif; overflow: hidden; 
            user-select: none; -webkit-user-select: none; touch-action: none; 
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" style="font-size:24px"><text y="24">ğŸ</text></svg>'), auto; 
            transition: background-color 0.5s ease; 
        }

        /* =========================================
           2. èƒŒæ™¯ç•«å¸ƒèˆ‡ç¶²æ ¼ (Canvas & Grid)
           ========================================= */
        #matrix-bg {
            position: fixed; top: 0; left: 0;
            width: 100vw; height: 100vh;
            z-index: 0; 
            pointer-events: none; 
            opacity: 0.6; 
        }

        .bg-grid { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            z-index: 1; pointer-events: none; 
            background-image: linear-gradient(rgba(157, 0, 255, 0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(157, 0, 255, 0.1) 1px, transparent 1px); 
            background-size: 40px 40px; 
        }
        body.pineapple-mode .bg-grid { background-image: linear-gradient(rgba(255, 204, 0, 0.15) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 204, 0, 0.15) 1px, transparent 1px); }

        .crt::before { 
            content: " "; display: block; position: fixed; top: 0; left: 0; bottom: 0; right: 0; 
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06)); 
            z-index: 9990; background-size: 100% 2px, 3px 100%; pointer-events: none; opacity: var(--crt-opacity); 
        }

        /* =========================================
           âœ¨ BIOS çµ‚ç«¯æ©Ÿèˆ‡é–‹æ©Ÿå‹•ç•« âœ¨
           ========================================= */
        #crt-boot {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: transparent; 
            z-index: 10000; pointer-events: none;
            display: flex; justify-content: center; align-items: center;
        }
        .crt-line {
            width: 0; height: 2px; background: #ff00ff; 
            box-shadow: 0 0 15px #ff00ff, 0 0 30px #ff00ff;
            animation: crt-turn-on 1.8s cubic-bezier(0.23, 1, 0.32, 1) forwards;
        }
        @keyframes crt-turn-on {
            0% { width: 0; height: 2px; opacity: 1; }
            30% { width: 100%; height: 2px; opacity: 1; }
            40% { height: 100vh; background: rgba(255, 0, 255, 0.7); opacity: 1; }
            70% { height: 100vh; background: transparent; opacity: 1; }
            100% { height: 100vh; background: transparent; opacity: 0; }
        }

        #bios-screen { 
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            background: #000; color: #ff00ff; 
            z-index: 9999; padding: 20px; font-size: 16px; box-sizing: border-box; 
            text-shadow: 0 0 5px #ff00ff; 
        }

        /* =========================================
           3. å´é‚Šæ¬„èˆ‡è¦–çª— UI
           ========================================= */
        .layout-container { display: flex; height: 100%; width: 100%; position: relative; z-index: 10; }
        .sidebar { width: 250px; background-color: var(--sidebar-bg); border-right: 2px solid var(--win-border); padding: 30px 20px; display: flex; flex-direction: column; position: relative; z-index: 50; }
        .logo-area h1 { color: #fff; font-size: 26px; margin: 0; line-height: 1.2; text-shadow: 2px 2px 0px var(--win-border); }
        .nav-links { list-style: none; padding: 0; margin: 20px 0 0 0; flex-grow: 1; overflow-y: auto;}
        .nav-links li { margin-bottom: 12px; }
        .nav-links a { color: var(--text-color); text-decoration: none; font-size: 18px; display: block; cursor: inherit; transition: 0.2s;}
        .nav-links a:hover { color: var(--highlight-color); transform: translateX(5px); }
        .mode-toggle { background: #000; border: 2px solid var(--win-border); color: var(--text-color); padding: 10px; font-family: 'DotGothic16'; cursor: inherit; margin-top: 20px; font-size: 16px; }
        .mode-toggle:hover { background: var(--win-border); color: #000; }

        .main-content { flex-grow: 1; position: relative; }
        .window { position: absolute; background-color: var(--win-bg); color: var(--win-text); border: 2px solid #fff; border-right-color: #555; border-bottom-color: #555; box-shadow: var(--win-shadow); z-index: 10; display: flex; flex-direction: column; touch-action: none; /* è®“æ•´å€‹è¦–çª—ä¸å— iOS æ‰‹å‹¢å¹²æ“¾ */ }
        
        /* âœ¨ è¦–çª—ç´«è‰²æ¨™é¡Œåˆ— - æ‹–æ›³çš„æŠ“å–å€ï¼ŒåŠ å…¥ touch-action: none ç¢ºä¿æ‰‹æ©Ÿå®Œç¾æ‹–æ›³ */
        .window-header { background-color: var(--win-border); color: #fff; padding: 4px 8px; font-weight: bold; display: flex; justify-content: space-between; align-items: center; cursor: grab; user-select: none; -webkit-user-select: none; touch-action: none; }
        .window-header:active { cursor: grabbing; }
        
        .close-btn { background: var(--win-bg); color: #000; border: 1px solid #fff; border-right-color: #555; border-bottom-color: #555; padding: 0 6px; cursor: inherit; font-size: 12px; font-weight: bold; }
        .close-btn:active { border: 1px solid #555; border-right-color: #fff; border-bottom-color: #fff; }
        
        .window-content { padding: 12px; font-size: 14px; flex-grow: 1; overflow-y: auto; text-align: center; }
        .sys-btn { background: var(--btn-bg); color: var(--win-text); padding: 4px 12px; display: inline-block; margin-top: 10px; font-size: 14px; border: 2px solid #fff; border-right-color: #555; border-bottom-color: #555; cursor: inherit; }
        .sys-btn:active { border: 2px solid #555; border-right-color: #fff; border-bottom-color: #fff; }
        .sys-btn.yes:hover { color: var(--highlight-color); font-weight: bold; }

        /* é›»è…¦ç‰ˆé è¨­åº§æ¨™ */
        .teaser-win { width: 240px; } 
        #win-1 { top: 50px; left: 50px; } #win-2 { top: 90px; left: 340px; } #win-3 { top: 260px; left: 80px; }
        #win-4 { top: 320px; left: 380px; } #win-5 { top: 480px; left: 140px; } #win-6 { top: 520px; left: 450px; } #win-7 { top: 180px; left: 620px; }

        #main-app-window { width: 600px; height: 400px; display: none; max-width: 90vw; max-height: 80vh; }
        #main-app-window .window-content { background: #fff; border: inset 2px #555; margin: 10px; padding: 15px; text-align: left; }
        body.tranquil-mode #main-app-window .window-content { background: #333; }
        body.pineapple-mode #main-app-window .window-content { background: #ffffe6; }

        .desktop-icon { position: absolute; bottom: 60px; right: 40px; text-align: center; color: var(--text-color); cursor: pointer; z-index: 5; text-shadow: 2px 2px 0px #000; }
        .desktop-icon .icon-img { font-size: 40px; margin-bottom: 5px; }
        .desktop-icon:hover { transform: scale(1.1); color: var(--highlight-color); }
        
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(0,0,0,0.6); z-index: 9000; }
        .alert-modal { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 300px; z-index: 9001; }
        
        .marquee-container { 
            position: fixed; bottom: 0; left: 0; width: 100vw; 
            background: var(--win-border); color: #fff; 
            padding: 4px 0; z-index: 100; border-top: 2px solid #fff; 
            padding-bottom: env(safe-area-inset-bottom, 4px); 
        }
        .marquee-content { display: inline-block; white-space: nowrap; animation: marquee 20s linear infinite; font-size: 16px; }
        @keyframes marquee { 0% { transform: translateX(100vw); } 100% { transform: translateX(-100%); } }

        .particle { position: fixed; pointer-events: none; z-index: 9999; animation: explode 0.8s cubic-bezier(0.1, 0.8, 0.3, 1) forwards; font-size: 16px;}
        @keyframes explode { 0% { transform: translate(0, 0) scale(1) rotate(0deg); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) scale(0) rotate(720deg); opacity: 0; } }
        .trail-particle { position: fixed; pointer-events: none; z-index: 9998; animation: fadeTrail 0.4s linear forwards; }
        @keyframes fadeTrail { 0% { opacity: 0.8; transform: scale(1); } 100% { opacity: 0; transform: scale(0.2) translateY(15px); } }
        .blink { animation: blinker 1s linear infinite; }
        @keyframes blinker { 50% { opacity: 0; } }

        /* =========================================
           ğŸ“± æ‰‹æ©Ÿç‰ˆå°ˆå±¬è¨­å®š (çµ‚æ¥µä¿®å¾©æ–¹æ¡ˆ)
           ========================================= */
        @media (max-width: 800px) {
            .layout-container { flex-direction: column; }
            .sidebar { width: 100%; height: auto; border-right: none; border-bottom: 2px solid var(--win-border); padding: 15px; box-sizing: border-box;}
            .logo-area h1 { font-size: 20px; text-align: center; }
            .nav-links { margin: 10px 0; text-align: center;}
            .nav-links li { display: inline-block; margin: 0 8px; }
            .nav-links a { font-size: 16px; }
            .mode-toggle { width: 100%; margin-top: 5px; }

            .teaser-win { width: 160px; } 
            #win-1 { top: 2vh; left: 2vw; } 
            #win-2 { top: 8vh; left: 15vw; } 
            #win-3 { top: 14vh; left: 30vw; }
            #win-4 { top: 20vh; left: 5vw; } 
            #win-5 { top: 26vh; left: 25vw; } 
            #win-6 { top: 32vh; left: 45vw; } 
            #win-7 { top: 38vh; left: 10vw; }
            
            #main-app-window { width: 95vw; height: 60dvh; top: 10vh !important; left: 2.5vw !important; } 

            .desktop-icon { bottom: calc(40px + env(safe-area-inset-bottom, 20px) + 50px); right: 5vw; } 
        
            #game-window { 
                width: 95vw !important; 
                height: auto !important; 
                top: 5vh !important; 
            }
            
            #game-window .window-content { 
                aspect-ratio: auto !important; 
                min-height: 320px !important;  
                height: auto !important;       
                display: flex !important;
                flex-direction: column !important;
                justify-content: center !important;
                touch-action: none !important; 
                -webkit-touch-callout: none !important; 
                -webkit-user-select: none !important; 
                user-select: none !important; 
            }
            
            #run-canvas { 
                object-fit: contain !important; 
                width: 100% !important; 
                height: auto !important;
                max-height: 100% !important; 
            } 
            #game-score { top: 15px !important; right: 15px !important; font-size: 16px !important; }
        }
    </style>
</head>
<body class="crt noise-mode">
    <div id="crt-boot"><div class="crt-line"></div></div>

    <div id="bios-screen"><div id="bios-text"></div></div>
    
    <canvas id="matrix-bg"></canvas>
    
    <div class="bg-grid"></div>

    <div class="layout-container">
        <nav class="sidebar">
            <div class="logo-area"><h1 style="cursor:pointer" onclick="openGame()">å¯§éœéŸ³æ¨‚ç¯€<br>UNSILENCE OS</h1></div>
            <ul class="nav-links">
                <li><a onclick="openApp('NEWS_ARCHIVE.exe', 'news.html')">> NEWS</a></li>
                <li><a onclick="openApp('LIVE_DATA.sys', 'lineup.html')">> LIVE_é™£å®¹</a></li>
                <li><a onclick="openApp('TIMETABLE.exe', 'timetable.html')">> RELEASE_æ™‚åˆ»è¡¨</a></li>
                <li><a onclick="openApp('MAP_NAVIGATOR.sys', 'map.html')">> MAP_åœ°åœ–</a></li>
                <li><a onclick="openApp('STORE_DATA.pkg', 'goods.html')">> STORE_å‘¨é‚Š</a></li>
                <li><a onclick="openApp('SAFETY_PROTOCOL.txt', 'guidelines.html')">> INFO_é ˆçŸ¥</a></li>
                <li><a onclick="openApp('CREDITS.txt', 'credits.html')" style="color:var(--highlight-color)">> CREDITS_åå–®</a></li>
            </ul>
            <button class="mode-toggle" id="mode-toggle">æ¨¡å¼åˆ‡æ›: é›œè¨Š</button>
        </nav>

        <main class="main-content">
            <div class="window teaser-win" id="win-1"><div class="window-header"><span class="title">ğŸ’¾ NEWS.exe</span><span class="close-btn">X</span></div><div class="window-content"><p>å®˜ç¶²ç³»çµ±å•Ÿå‹•</p><button class="sys-btn yes" onclick="openApp('NEWS_ARCHIVE.exe', 'news.html')">è®€å–(Y)</button></div></div>
            <div class="window teaser-win" id="win-2"><div class="window-header"><span class="title">ğŸµ LIVE.txt</span><span class="close-btn">X</span></div><div class="window-content"><p>æ¼”å‡ºé™£å®¹è§£ç¦</p><button class="sys-btn yes" onclick="openApp('LIVE_DATA.sys', 'lineup.html')">æŸ¥çœ‹(Y)</button></div></div>
            <div class="window teaser-win" id="win-3"><div class="window-header"><span class="title">â³ TIME.exe</span><span class="close-btn">X</span></div><div class="window-content"><p>è®€å–æ™‚é–“è»¸</p><button class="sys-btn yes" onclick="openApp('TIMETABLE.exe', 'timetable.html')">å±•é–‹(Y)</button></div></div>
            <div class="window teaser-win" id="win-4"><div class="window-header"><span class="title">ğŸ—ºï¸ MAP.sys</span><span class="close-btn">X</span></div><div class="window-content"><p>åº§æ¨™ç¢ºèª(G9)</p><button class="sys-btn yes" onclick="openApp('MAP_NAVIGATOR.sys', 'map.html')">æƒæ(Y)</button></div></div>
            <div class="window teaser-win" id="win-5"><div class="window-header"><span class="title">ğŸ›ï¸ STORE.pkg</span><span class="close-btn">X</span></div><div class="window-content"><p>å‘¨é‚Šé è³¼ä¸­</p><button class="sys-btn yes" onclick="openApp('STORE_DATA.pkg', 'goods.html')">è³¼è²·(Y)</button></div></div>
            <div class="window teaser-win" id="win-6"><div class="window-header"><span class="title">âš ï¸ INFO.txt</span><span class="close-btn">X</span></div><div class="window-content"><p>å®‰å…¨è¦ç¯„é ˆçŸ¥</p><button class="sys-btn yes" onclick="openApp('SAFETY_PROTOCOL.txt', 'guidelines.html')">ç¢ºèª(Y)</button></div></div>
            <div class="window teaser-win" id="win-7"><div class="window-header"><span class="title">ğŸ“œ CREDITS.txt</span><span class="close-btn">X</span></div><div class="window-content"><p>ç³»çµ±è£½ä½œç¾¤è§£å¯†</p><button class="sys-btn yes" onclick="openApp('CREDITS.txt', 'credits.html')">è§£å¯†(Y)</button></div></div>

            <div class="window" id="main-app-window"><div class="window-header"><span class="title" id="app-window-title">SYSTEM_APP.exe</span><span class="close-btn" onclick="closeApp()">X</span></div><div class="window-content" id="app-dynamic-content"></div></div>
            
            <div class="window" id="game-window" style="display: none; width: 800px; max-width: 95vw; height: auto; position: absolute; top: 10vh; left: 50%; transform: translateX(-50%); z-index: 9999;">
                <div class="window-header">
                    <span class="title">ğŸ¦ƒ ESCAPE.exe - ç³»çµ±ç•°å¸¸çªç ´</span>
                    <span class="close-btn" onclick="closeGame()">X</span>
                </div>
                <div class="window-content" style="padding: 0; background-color: #05020a; position: relative; overflow: hidden; display: flex; flex-direction: column; align-items: center; justify-content: center; aspect-ratio: 8/3;">
                <div id="game-score" style="position: absolute; top: 10px; right: 20px; color: #0f0; font-size: 20px; font-weight: bold; text-shadow: 2px 2px 0 #000; z-index: 10; pointer-events: none;">SCORE: 0</div>                    
                    <div id="game-msg" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; color: #0f0; text-align: center; z-index: 10; cursor: pointer; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0,0,0,0.6);">
                        <h2 class="blink" style="margin: 0; color: #ff00ff; font-size: 2rem; text-shadow: 2px 2px #000;">SYSTEM BREACH</h2>
                        <p style="margin-top: 10px; font-size: 1.2rem; text-shadow: 1px 1px #000;">> é»æ“Šç•«é¢ æˆ– æŒ‰ç©ºç™½éµé–‹å§‹é€ƒäº¡ &lt;</p>
                    </div>
                    <canvas id="run-canvas" width="800" height="300" style="display: block; cursor: pointer;"></canvas>
                </div>
            </div>
            
            <div class="desktop-icon blink" onclick="showIgWarning()"><div class="icon-img">ğŸ“·</div><div>IG_LINK.url</div></div>
        </main>
    </div>

    <div class="modal-overlay" id="ig-overlay" onclick="closeIgWarning()"></div>
    <div class="window alert-modal" id="ig-modal">
        <div class="window-header" style="background-color: #aa0000;"><span class="title">âš ï¸ ç³»çµ±è­¦å‘Š</span><span class="close-btn" onclick="closeIgWarning()">X</span></div>
        <div class="window-content">
            <p>å³å°‡é›¢é–‹å¯§éœ OSï¼Œé€£æ¥è‡³å¤–éƒ¨ç¤¾ç¾¤ç¶²è·¯ (Instagram)ã€‚</p>
            <p style="color:#aa0000; font-weight:bold;">æ˜¯å¦æˆæ¬Šé–‹å•Ÿï¼Ÿ</p>
            <div style="margin-top:15px; display:flex; justify-content:space-around;">
                <a href="https://www.instagram.com/unsilence_fest._?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank" class="sys-btn yes" onclick="closeIgWarning()">æˆæ¬Š (Y)</a>
                <button class="sys-btn" onclick="closeIgWarning()">æ‹’çµ• (N)</button>
            </div>
        </div>
    </div>

    <div class="marquee-container"><div class="marquee-content">/// 2026.05.20 å¯§éœéŸ³æ¨‚ç¯€ /// å˜‰ç¾©æ–‡åŒ–åœ’å€ /// ä¸»è¾¦å–®ä½ï¼šä¸­æ­£å¤§å­¸ /// å…¨ç¨‹å…è²»å…¥å ´ /// ğŸ æ¸¸æ¨™ç•°å¸¸å¹²æ“¾ä¸­ ///</div></div>

    <script>
        // ==========================================
        // 1. BIOS é–‹æ©Ÿè¼‰å…¥å‹•ç•«
        // ==========================================
        const biosLines = [
            "[0x0000] INITIATING KERNEL_CORE...",
            "[0x001A] ALLOCATING MEMORY BLOCK...",
            "[0xCCU] ALLOCATING CSIE_MODULE...",
            "[0x002B] MOUNTING SIGNAL_PROCESSOR...",
            "...",
            "> BOOTING TRANQUIL_OS...",
            "> MOUNTING PINEAPPLE_DRIVE...",
            "> LOADING FETCH_MODULE... OK",
            "> SYSTEM READY."
        ];
        
        const biosText = document.getElementById('bios-text'); 
        let lineIdx = 0;
        
        function showBios() { 
            if (lineIdx < biosLines.length) { 
                biosText.innerHTML += biosLines[lineIdx] + "<br>"; 
                lineIdx++; 
                setTimeout(showBios, 150); 
            } else { 
                setTimeout(() => {
                    const biosScreen = document.getElementById('bios-screen');
                    biosScreen.style.transition = "opacity 0.6s ease";
                    biosScreen.style.opacity = "0";
                    setTimeout(() => { biosScreen.style.display = 'none'; }, 600); 
                }, 500); 
            } 
        }
        
        window.onload = () => {
            setTimeout(showBios, 1200);
            setTimeout(() => { document.getElementById('crt-boot').remove(); }, 2500); 
        };

        // ==========================================
        // 2. âœ¨ å®Œç¾å…¨è¦–çª—æ‹–æ›³ç³»çµ± (ç›¸å®¹æ‰€æœ‰ç›¸å°åº§æ¨™èˆ‡ç½®ä¸­) âœ¨
        // ==========================================
        const windows = document.querySelectorAll('.window:not(.alert-modal)'); 
        let topZ = 100;

        windows.forEach(win => {
            const header = win.querySelector('.window-header'); 
            let isDragging = false;
            let offsetX, offsetY;

            // é»æ“Šæ¨™é¡Œåˆ—é–‹å§‹æ‹–æ›³
            const startDrag = (e) => {
                // å¦‚æœé»æ“Š X æŒ‰éˆ•ï¼Œæ‹’çµ•æ‹–æ›³
                if (e.target.classList.contains('close-btn')) return;
                
                isDragging = true;
                win.style.zIndex = ++topZ; 

                // âœ¨ æœ€é—œéµé­”æ³•ï¼šè®€å–ã€Œç•¶å‰ç•«é¢ä¸Šæœ€çœŸå¯¦çš„åƒç´ ä½ç½®ã€
                const rect = win.getBoundingClientRect();
                
                // æ‹”é™¤æ‰€æœ‰ç›¸å°å®šä½(vw/vh)å’Œç½®ä¸­é­”æ³•(transform)ï¼Œæ”¹æˆçµ•å°çš„ px åƒç´ å®šä½
                win.style.transform = 'none'; 
                win.style.margin = '0';
                win.style.bottom = 'auto'; // æ¸…é™¤å¯èƒ½æœ‰çš„ bottom å½±éŸ¿
                win.style.right = 'auto';  // æ¸…é™¤å¯èƒ½æœ‰çš„ right å½±éŸ¿
                win.style.left = `${rect.left}px`;
                win.style.top = `${rect.top}px`;
                
                // è¨ˆç®—æ‰‹æŒ‡/æ¸¸æ¨™ç›¸å°æ–¼è¦–çª—å·¦ä¸Šè§’çš„åç§»é‡
                offsetX = e.clientX - rect.left;
                offsetY = e.clientY - rect.top;
                
                // å°å°æ‰‹æ©Ÿæ»‘å‹•è¡Œç‚º
                if (e.pointerType === 'touch') win.style.touchAction = 'none';
            };

            // æ»‘å‹•éç¨‹
            const moveDrag = (e) => {
                if (!isDragging) return;
                e.preventDefault(); 
                
                // ä¾ç…§æ‰‹æŒ‡/æ¸¸æ¨™ä½ç½®èˆ‡å‰›æ‰çš„åç§»é‡ï¼Œå¯¦æ™‚æ›´æ–°è¦–çª—ä½ç½®
                win.style.left = `${e.clientX - offsetX}px`;
                win.style.top = `${e.clientY - offsetY}px`;
            };

            // æ”¾é–‹æ‹–æ›³
            const stopDrag = () => {
                isDragging = false;
                if (win.style.touchAction === 'none') win.style.touchAction = '';
            };

            // ç¶å®šäº‹ä»¶
            header.addEventListener('pointerdown', startDrag);
            document.addEventListener('pointermove', moveDrag, { passive: false });
            document.addEventListener('pointerup', stopDrag);
            document.addEventListener('pointercancel', stopDrag);

            // X æŒ‰éˆ•é—œé–‰é‚è¼¯
            if (win.classList.contains('teaser-win')) {
                win.querySelector('.close-btn').onclick = () => win.style.display = 'none';
            }
        });

        // ==========================================
        // 3. å…¶ä»– OS UI åŠŸèƒ½ (è¼‰å…¥ã€è­¦å‘Šã€æ¨¡å¼)
        // ==========================================
        async function openApp(windowTitle, fileUrl) {
            const appWin = document.getElementById('main-app-window'); const contentArea = document.getElementById('app-dynamic-content'); const titleArea = document.getElementById('app-window-title');
            appWin.style.display = 'flex'; appWin.style.zIndex = ++topZ;
            
            if(window.innerWidth > 800) { 
                appWin.style.top = `${80 + Math.floor(Math.random() * 20)}px`; 
                appWin.style.left = `${150 + Math.floor(Math.random() * 20)}px`; 
            } else { 
                appWin.style.top = `20px`;  
                appWin.style.left = `2.5vw`; 
            }
            
            titleArea.innerText = `ğŸ“ ${windowTitle}`; contentArea.innerHTML = "<h3 class='blink'>> è®€å–è³‡æ–™ä¸­ / LOADING DATA...</h3>";
            try { const response = await fetch(fileUrl); if (!response.ok) throw new Error('File not found'); const htmlContent = await response.text(); contentArea.innerHTML = htmlContent; } catch (error) { contentArea.innerHTML = `<h3 style='color:red;'>[ ç³»çµ±éŒ¯èª¤ ] ç„¡æ³•é€£æ¥åˆ°ä¿¡è™Ÿæº (${fileUrl})</h3><p>è«‹ç¢ºèªæ‚¨æ˜¯å¦ä½¿ç”¨ Live Server é–‹å•Ÿç¶²é ï¼Ÿ</p>`; }
        }
        function closeApp() { document.getElementById('main-app-window').style.display = 'none'; document.getElementById('app-dynamic-content').innerHTML = ''; }
        
        function showIgWarning() { document.getElementById('ig-overlay').style.display = 'block'; document.getElementById('ig-modal').style.display = 'block'; }
        function closeIgWarning() { document.getElementById('ig-overlay').style.display = 'none'; document.getElementById('ig-modal').style.display = 'none'; }
        
        const modes = ['noise', 'tranquil', 'pineapple']; const modeLabels = ['æ¨¡å¼åˆ‡æ›: é›œè¨Š', 'æ¨¡å¼åˆ‡æ›: å¯§éœ', 'æ¨¡å¼åˆ‡æ›: ğŸé³³æ¢¨']; let currentModeIndex = 0;
        document.getElementById('mode-toggle').onclick = (e) => { document.body.classList.remove(`${modes[currentModeIndex]}-mode`); currentModeIndex = (currentModeIndex + 1) % modes.length; document.body.classList.add(`${modes[currentModeIndex]}-mode`); e.target.innerText = modeLabels[currentModeIndex]; };

        // é³³æ¢¨èˆ‡ç‰¹æ•ˆ
        const defaultColors = ['#ff00ff', '#00ff00', '#ffffff', '#9d00ff'];
        const createExplosion = (x, y) => { if(document.body.classList.contains('tranquil-mode')) return; const isPineapple = document.body.classList.contains('pineapple-mode'); const particleCount = isPineapple ? 12 : 30; for (let i = 0; i < particleCount; i++) { const p = document.createElement('div'); p.className = 'particle'; p.style.left = `${x}px`; p.style.top = `${y}px`; if (isPineapple) { p.innerText = 'ğŸ'; } else { const size = Math.random() * 6 + 4; p.style.width = `${size}px`; p.style.height = `${size}px`; p.style.backgroundColor = defaultColors[Math.floor(Math.random() * defaultColors.length)]; } const angle = Math.random() * Math.PI * 2; const distance = Math.random() * 150 + 50; p.style.setProperty('--tx', `${Math.cos(angle) * distance}px`); p.style.setProperty('--ty', `${Math.sin(angle) * distance}px`); document.body.appendChild(p); setTimeout(() => p.remove(), 800); } };
        const createTrail = (x, y) => { if(document.body.classList.contains('tranquil-mode') || Math.random() > 0.6) return; const trail = document.createElement('div'); trail.className = 'trail-particle'; trail.style.left = `${x}px`; trail.style.top = `${y}px`; if(document.body.classList.contains('pineapple-mode')){ trail.innerText = 'ğŸ'; trail.style.fontSize = '12px'; } else { trail.style.width = '4px'; trail.style.height = '4px'; trail.style.backgroundColor = defaultColors[Math.floor(Math.random() * defaultColors.length)]; } document.body.appendChild(trail); setTimeout(() => trail.remove(), 400); };
        document.addEventListener('mousedown', (e) => { if(!e.target.closest('#ig-modal') && !e.target.closest('.window-header')) createExplosion(e.clientX, e.clientY); }); document.addEventListener('touchstart', (e) => { if(!e.target.closest('#ig-modal') && !e.target.closest('.window-header')) createExplosion(e.touches[0].clientX, e.touches[0].clientY); }, {passive: true}); document.addEventListener('mousemove', (e) => createTrail(e.clientX, e.clientY)); document.addEventListener('touchmove', (e) => createTrail(e.touches[0].clientX, e.touches[0].clientY), {passive: true});

        // ==========================================
        // 4. å‹•æ…‹æ¡Œå¸ƒï¼šCanvas Matrix Rain
        // ==========================================
        const canvas = document.getElementById('matrix-bg');
        const ctx = canvas.getContext('2d');
        let cw, ch; const fontSize = 18; let columns = [];
        const baseChars = 'ï½±ï½²ï½³ï½´ï½µï½¶ï½·ï½¸ï½¹ï½ºï½»ï½¼ï½½ï½¾ï½¿ï¾€ï¾ï¾‚ï¾ƒï¾„ï¾…ï¾†ï¾‡ï¾ˆï¾‰ï¾Šï¾‹ï¾Œï¾ï¾ï¾ï¾ï¾‘ï¾’ï¾“ï¾”ï¾•ï¾–ï¾—ï¾˜ï¾™ï¾šï¾›ï¾œï¾0123456789'.split('');
        const easterEgg = ['å¯§','å¯§','éœ','éœ','éŸ³','æ¨‚','ç¯€']; 
        const noiseChars = baseChars.concat(easterEgg);
        const pineappleChars = ['ğŸ'];

        function initCanvas() {
            cw = window.innerWidth; ch = window.innerHeight;
            canvas.width = cw; canvas.height = ch;
            const colCount = Math.floor(cw / fontSize) + 1;
            columns = [];
            for (let i = 0; i < colCount; i++) { columns[i] = Math.random() * -100; }
        }
        window.addEventListener('resize', initCanvas); initCanvas();

        function drawMatrix() {
            if (document.body.classList.contains('tranquil-mode')) { ctx.fillStyle = 'rgba(17, 17, 17, 0.15)'; ctx.fillRect(0, 0, cw, ch); return; }
            ctx.fillStyle = document.body.classList.contains('pineapple-mode') ? 'rgba(26, 26, 0, 0.15)' : 'rgba(10, 5, 16, 0.15)'; ctx.fillRect(0, 0, cw, ch); ctx.font = `${fontSize}px 'DotGothic16', monospace`; ctx.textBaseline = 'top'; ctx.fillStyle = document.body.classList.contains('pineapple-mode') ? '#ffcc00' : '#0f0'; const chars = document.body.classList.contains('pineapple-mode') ? pineappleChars : noiseChars; for (let i = 0; i < columns.length; i++) { const char = chars[Math.floor(Math.random() * chars.length)]; const x = i * fontSize; const y = columns[i] * fontSize; ctx.fillText(char, x, y); if (y > ch && Math.random() > 0.975) { columns[i] = 0; } else { columns[i]++; } }
        }
        setInterval(drawMatrix, 50);

    </script>
    <script src="game.js?v=4.2"></script>
</body>
</html>